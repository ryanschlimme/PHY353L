nycflights13 %>%
filter(origin == "JFK", month == 12)
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, 1, 0))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, 1, 0)) %>%
summarize(prop(overHour))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, 1, 0)) %>%
summarize(prop(overHour))
library(mosaic)
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, 1, 0)) %>%
summarize(prop(overHour))
nycflights13 %>%
filter(carrier == "DL", dep_delay != "NA")
nycflights13 %>%
filter(carrier == "DL", dep_delay != "NA") %>%
group_by(origin)
nycflights13 %>%
filter(carrier == "DL", dep_delay != "NA") %>%
group_by(origin) %>%
summarize(mean(dep_delay))
nycflights13 %>%
filter(carrier == "DL", dep_delay != "NA") %>%
group_by(origin) %>%
summarize(avgDelay = mean(dep_delay)) %>%
arrange(avgDelay)
nycflights13 %>%
filter(carrier == "DL", dep_delay != "NA") %>%
group_by(origin) %>%
summarize(avgDelay = mean(dep_delay)) %>%
arrange(desc(avgDelay))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, TRUE, FALSE)) %>%
summarize(prop(overHour))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, "Yes", "No")) %>%
summarize(prop(overHour))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, "Yes", "No")) %>%
summarize(prop(overHour, success = "Yes"))
nycflights13 %>%
filter(origin == "JFK", month == 12) %>%
mutate(overHour = ifelse(dep_delay >= 60, "Yes", "No")) %>%
summarize(prop(overHour == "Yes"))
NHANES_sleep <- read.csv("C:/Users/ryans/Downloads/NHANES_sleep.csv")
View(NHANES_sleep)
View(NHANES_sleep)
boot1 = do(10000)*mean(~SleepHrsNight, data = NHANES_sleep)
confint(boot1)
View(boot1)
boot1 = do(10000)*mean(~SleepHrsNight, data = resample(NHANES_sleep))
confint(boot1)
confint(boot1, level = 0.99)
boot2 = do(10000)*diffmean(SleepHrsNight ~ Gender)
boot2 = do(10000)*diffmean(SleepHrsNight ~ Gender, data = resample(NHANES_sleep))
confint(boot2, level = 0.85)
mean(SleepHrsNight ~ Gender, data = (NHANES_sleep))
diffmean(SleepHrsNight ~ Gender, data = (NHANES_sleep))
mean(SleepHrsNight ~ Gender, data = (NHANES_sleep))
6.763419 -6.996954
mean(Gender ~ SleepHrs, data = (NHANES_sleep))
mean(Gender ~ SleepHrsNight, data = (NHANES_sleep))
olympics_top20 <- read.csv("C:/Users/ryans/Downloads/olympics_top20.csv")
View(olympics_top20)
boot3 = do(1000)*lm(weight ~ height, data = resample(olympics_top20))
confint(boot3)
6680e3*10160/(42200e3)
NHANES_sleep <- read.csv("C:/Users/Ryan Schlimme/Downloads/NHANES_sleep.csv")
View(NHANES_sleep)
olympics_top20 <- read.csv("C:/Users/Ryan Schlimme/Downloads/olympics_top20.csv")
View(olympics_top20)
library(tidyverse)
library(mosaic)
NHANES_sleep %>%
summarize(sdSleep = sd(~SleepHrsNight),
N = n(),
SE = sdSleep / sqrt(N))
boot1 = do(10000)*mean(~SleepHrsNight, data = resample(NHANES_sleep))
sd(boot1)
View(boot1)
sd(~mean, boot1)
sd(~mean, data = boot1)
avg = mean(~SleepHrsNight, data = NHANES_sleep)
sigma = 0.02952488
ggplot(boot) +
geom_histogram(aes(x = mean, y = ..density..)) +
geom_function(fun = dnorm, args = list(mean = avg, sd = sigma)) +
xlim(6.75, 7)
ggplot(boot1) +
geom_histogram(aes(x = mean, y = ..density..)) +
geom_function(fun = dnorm, args = list(mean = avg, sd = sigma)) +
xlim(6.75, 7)
mean = (89.23 + 46.98)/2
sd = (89.23 - mean) / 3
mean
source("C:/Users/Ryan Schlimme/OneDrive/Desktop/STA301/2024 Spring/R Demos/03-26-2024, Large Sample Inference BLANK.R", echo=TRUE)
sd
sd = (89.23 - 46.98)/6
sd
upper = mean + sd
lower = mean - sd
upper1 = mean + 2*sd
lower1 = mean - 2*sd
ggplot() +
geom_function(fun = dnorm, args = list(mean = mean, sd = sd)) +
geom_vline(aes(xintercept = lower)) +
geom_vline(aes(xintercept = upper)) +
geom_vline(aes(xintercept = mean), color = "red") +
geom_vline(aes(xintercept = 46.98), color = "blue") +
geom_vline(aes(xintercept = 89.23), color = "blue") +
geom_vline(aes(xintercept = lower1), color = "purple") +
geom_vline(aes(xintercept = upper1), color = "purple") +
xlim(38, 100)
t.test(~SleepHrsNight, data = NHANES_sleep)
boot2 = do(10000)*mean(~SleepHrsNight, data = resample(NHANES_sleep))
confint(boot2)
t.test(SleepHrsNight ~ Gender, data = NHANES_sleep)
t.test(SleepHrsNight ~ Gender, data = NHANES_sleep, conf.level = 0.85)
6.996954             -6.763419
NHANES_sleep = NHANES_sleep %>%
mutate(over7 = ifelse(SleepHrsNight > 7, 1, 0))
prop.test(over7 ~ Gender, data = NHANES_sleep)
prop.test(over7 ~ Gender, data = NHANES_sleep, conf.level = 0.99)
prop(over7 ~ Gender, data = NHANES_sleep)
prop.test(over7 ~ Gender, data = NHANES_sleep, conf.level = 0.99, success = "1")
prop(over7 ~ Gender, data = NHANES_sleep)
NHANES_depressed = NHANES_sleep %>%
filter(Gender == "female") %>%
mutate(isDepressed = ifelse(Depressed != "None", 1, 0))
t.test(SleepHrsNight ~ isDepressed, data = NHANES_deressed)
t.test(SleepHrsNight ~ isDepressed, data = NHANES_depressed)
mean(SleepHrsNight ~ isDepressed, data = NHANES_depressed)
NHANES_depressed = NHANES_sleep %>%
filter(Gender == "female") %>%
mutate(isDepressed = ifelse(Depressed != "None", "YesDepressed", "NoDepressed"))
t.test(SleepHrsNight ~ isDepressed, data = NHANES_depressed)
NHANES_sleep = NHANES_sleep %>%
mutate(isDepressed = ifelse(Depressed != "None", "YesDepressed", "NoDepressed"))
NHANES_sleep = NHANES_sleep %>%
mutate(isDepressed = ifelse(Depressed != "None", "YesDepressed", "NoDepressed"))
prop.test(isDepressed ~ Smoke100, data = NHANES_sleep)
prop(isDepressed ~ Smoke100, data = NHANES_sleep)
prop.test(isDepressed ~ Smoke100, data = NHANES_sleep, success = "YesDepressed")
prop(isDepressed ~ Smoke100, data = NHANES_sleep, success = "YesDepressed")
NHANES_home = NHANES_sleep %>%
filter(HomeOwn != "Other")
prop.test(isDepressed ~ HomeOwn, data = NHANES_home)
prop(isDepressed ~ HomeOwn, data = NHANES_home)
prop.test(isDepressed ~ HomeOwn, data = NHANES_home, success = "YesDepressed")
prop(isDepressed ~ HomeOwn, data = NHANES_home, success = "YesDepressed")
prop.test(isDepressed ~ HomeOwn, data = NHANES_home, success = "YesDepressed",
conf.level = 0.99)
lm1 = lm(height ~ age, data = olympics_top20)
confint(lm1)
confint(lm1, level = 0.99)
ggplot(olympics_top20) +
geom_point(aes(x = height, y = weight))
ggplot(olympics_top20) +
geom_point(aes(x = weight, y = height))
olympics_top20 = olympics_top20 %>%
mutate(height10 = height / 10)
lm2 = lm(weight ~ height10, data = olympics_top20)
confint(lm2)
lm3 = lm(weight ~ height, data = olympics_top20)
confint(lm3)
t.test(age ~ sex, data = olympics_top20)
8.5e-2/14.5939*0.092903
2.6e-5/0.092903
2.6e-5/0.3048
evals <- read.csv("C:/Users/Ryan Schlimme/Downloads/evals.csv")
View(evals)
kroger <- read.csv("C:/Users/Ryan Schlimme/Downloads/kroger.csv")
View(kroger)
# Load libraries
library(tidyverse)
library(mosaic)
library(moderndive)
lm1 = lm(vol ~ price + disp, data = kroger)
coef(lm1)
7567.115 - 1324.240*5 + 1022.059*1
lm2 = lm(vol ~ price + disp + price:disp, data = kroger)
coef(lm2)
5828.8883 + 4378.1348
-701.7748 - 1251.3829
lm3 = lm(eval ~ gender + students + beauty + gender:beauty, data = evals)
coef(lm3)
confint(lm3)
4.774e-10*3.3356e-10
Groceries <- read.csv("C:/Users/Ryan Schlimme/OneDrive/Desktop/Groceries.csv")
View(Groceries)
library(tidyverse)
library(mosaic)
ggplot(Groceries) +
geom_histogram(aes(x = Total))
Groceries <- read.csv("C:/Users/Ryan Schlimme/OneDrive/Desktop/Groceries.csv")
View(Groceries)
ggplot(Groceries) +
geom_histogram(aes(x = Total))
ggplot(Groceries) +
geom_histogram(aes(x = Total), bars = 5)
ggplot(Groceries) +
geom_histogram(aes(x = Total), bins = 5)
ggplot(Groceries) +
geom_histogram(aes(x = Total), bins = 6)
favstats(~Total, data = Groceries)
Q3 = quantile(~Total, 0.75, data = Groceries)
Q3 = quantile(~Total, probs = 0.75, data = Groceries)
Q3
Q3 = quantile(Total, 0.75, data = Groceries)
Q3 = Groceries %>% summarize(quantile(Total, 0.75))
View(Q3)
Q3 = Groceries %>% summarize(quantile(Total, 0.75)) %>% pluck()
View(Groceries)
View(Q3)
Q3 = Groceries %>% summarize(quantile(Total, 0.75)) %>% as_double()
Q3 = Groceries %>% summarize(quantile(Total, 0.75)) %>% as.double()
Q1 = Groceries %>%
summarize(quantile(Total, 0.25)) %>%
as.double()
IQR = iqr(~Total, data = Groceries)
GroceriesFiltered = Groceries %>%
filter((Total < Q3 + 1.5*IQR) & (Total > Q1 - 1.5*IQR))
GroceriesFiltered = Groceries %>%
filter((Total < Q3 + 1.5*IQR))
Q3 + 1.5*IQR
Q1 - 1.5*IQR
boot = do(100000)*mean(~Total, data = resample(Groceries))
confint(boot)
View(Groceries)
View(Groceries)
View(Groceries)
GroceriesFiltered = Groceries[-c(4,7,5,11,12,15,12),]
boot = do(100000)*mean(~Total, data = resample(GroceriesFiltered))
confint(boot)
ggplot(Groceries) +
geom_histogram(aes(x = Total), bins = 6)
Charge <- read.csv("C:/Users/Ryan Schlimme/OneDrive/Desktop/Charge.csv", sep="")
View(Charge)
library(tidyverse)
ggplot(Charge) +
geom_histogram(aes(x = Charge))
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 20)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 30)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 35)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 32)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 30)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 50)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 70)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 75)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 100)
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 90)
Charge_mod = Charge %>%
filter(Charge < 6.1e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 90)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 30)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 50)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 40)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 35)
Charge_mod = Charge %>%
filter(Charge < 1.2e-18)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 35)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 40)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3.3e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3.2e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3.1e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.2e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6.3e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6.2e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6.1e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 5.5e-20)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 5.5e-20) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6.1e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6.1e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19)
View(Charge_mod)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19) +
geom_vline(xintercept = 7e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19) +
geom_vline(xintercept = 8e-19)
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19) +
geom_vline(xintercept = 7.3e-19)
e1 = Charge_mod %>%
filter(Charge < 3e-19) %>%
summarize(count1 = n(),
mean1 = mean(Charge),
sd1 = sd(Charge))
View(e1)
e1 = Charge_mod %>%
filter(Charge < 3e-19) %>%
summarize(count1 = n(),
mean1 = mean(Charge),
sd1 = sd(Charge)) %>%
filter(Charge < 4.3e-19 & Charge > 3e-19) %>%
summarize(count2 = n(),
mean2 = mean(Charge),
sd2 = sd(Charge))
e1 = Charge_mod %>%
filter(Charge < 3e-19)
e2 = Charge_mod %>%
filter(Charge < 4.3e-19 & Charge > 3e-19)
e3 = Charge_mod %>%
filter(Charge < 6e-19 & Charge > 4.33e-19)
e3 = Charge_mod %>%
filter(Charge < 6e-19 & Charge > 4.3e-19)
e4 = Charge_mod %>%
filter(Charge < 7.3e-19 & Charge > 6e-19)
library(mosaic)
mean1 = mean(~Charge, data = e1)
mean2 = mean(~Charge, data = e2)
mean3 = mean(~Charge, data = e3)
mean4 = mean(~Charge, data = e4)
sd1 = sd(~Charge, data = e1) / n()
sd1 = sd(~Charge, data = e1) / sqrt(28)
sd2 = sd(~Charge, data = e2) / sqrt(9)
sd3 = sd(~Charge, data = e3) / sqrt(15)
sd4 = sd(~Charge, data = e4) / sqrt(6)
mean2 - mean1
mean3 - mean2
mean4 - mean3
mean(mean2 - mean1, mean3 - mean2, mean4 - mean3)
diff1 = mean2 - mean1
error1 = sqrt(sd1^2/28 + sd2^2/9)
diff2 = mean3 - mean1
error2 = sqrt(sd2^2/9 + sd3^2/15)
diff2 = mean3 - mean2
diff3 = mean4 - mean3
error3 = sqrt(sd4^2/6 + sd3^2/15)
mean(diff1, diff2, diff3)
error1 = sd1^2/28 + sd2^2/9
diff1 = mean2 - mean1             # Difference in means
error1 = sd1^2/28 + sd2^2/9       # Variance for diff in means
diff2 = mean3 - mean2
error2 = sd2^2/9 + sd3^2/15
diff3 = mean4 - mean3
error3 = sd4^2/6 + sd3^2/15
mean(diff1, diff2, diff3)
sqrt(mean(error1, error2, error3))  # Sd of mean variance
mean(diff1, diff2, diff3) * 10^9         # Average difference
mean(diff1, diff2, diff3) * 10^19         # Average difference
sqrt(mean(error1, error2, error3)) * 10^19  # Sd of mean variance
library(tidyverse)
library(tidyverse)
library(tidyverse)
library(mosaic)
# Quick check of all data
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 90)
# Removing high charge, low count data
Charge_mod = Charge %>%
filter(Charge < 1.2e-18)
# Histogram with cutoffs for mean/sd calculation
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19) +
geom_vline(xintercept = 7.3e-19)
# Separating data for mean/sd calculation
e1 = Charge_mod %>%
filter(Charge < 3e-19)
e2 = Charge_mod %>%
filter(Charge < 4.3e-19 & Charge > 3e-19)
e3 = Charge_mod %>%
filter(Charge < 6e-19 & Charge > 4.3e-19)
e4 = Charge_mod %>%
filter(Charge < 7.3e-19 & Charge > 6e-19)
# Means
mean1 = mean(~Charge, data = e1)
mean2 = mean(~Charge, data = e2)
mean3 = mean(~Charge, data = e3)
mean4 = mean(~Charge, data = e4)
# Standard Deviations
sd1 = sd(~Charge, data = e1)
sd2 = sd(~Charge, data = e2)
sd3 = sd(~Charge, data = e3)
sd4 = sd(~Charge, data = e4)
# Difference in Means
diff1 = mean2 - mean1
diff2 = mean3 - mean2
diff3 = mean4 - mean3
# Variance for difference in means
error1 = sd2^2/9 + sd1^2/28
error2 = sd3^2/15 + sd2^2/9
error3 = sd4^2/6 + sd3^2/15
# Average difference
mean(diff1, diff2, diff3) * 10^19
# Sd of mean variance
sqrt(mean(error1, error2, error3)) * 10^19
# Histogram with cutoffs for mean/sd calculation
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19) +
geom_vline(xintercept = 7.3e-19)
# Histogram with cutoffs for mean/sd calculation
ggplot(Charge_mod) +
geom_histogram(aes(x = Charge), bins = 45) +
geom_vline(xintercept = 3e-19) +
geom_vline(xintercept = 4.3e-19) +
geom_vline(xintercept = 6e-19) +
geom_vline(xintercept = 7.3e-19)
# Quick check of all data
ggplot(Charge) +
geom_histogram(aes(x = Charge), bins = 90)
# Save dataframe for use in Python
write.csv(Charge_mod, "C:\Users\Ryan Schlimme\OneDrive\
# Save dataframe for use in Python
write.csv(Charge_mod, r"C:\Users\Ryan Schlimme\OneDrive\
# Save dataframe for use in Python
write.csv(Charge_mod, r"C:\Users\Ryan Schlimme\OneDrive\Desktop\College\Spring 2024\PHY353L\Labs\Lab 5")
# Save dataframe for use in Python
write.csv(Charge_mod, "C:\\Users\\Ryan Schlimme\\OneDrive\\Desktop\\College\\Spring 2024\\PHY353L\\Labs\\Lab 5")
# Save dataframe for use in Python
getwd()
# Save dataframe for use in Python
setwd("C:\\Users\\Ryan Schlimme\\OneDrive\\Desktop\\College\\Spring 2024\\PHY353L\\Labs\\Lab 5"
# Save dataframe for use in Python
setwd("C:\\Users\\Ryan Schlimme\\OneDrive\\Desktop\\College\\Spring 2024\\PHY353L\\Labs\\Lab 5")
write.csv(Charge_mod, "C:\\Users\\Ryan Schlimme\\OneDrive\\Desktop\\College\\Spring 2024\\PHY353L\\Labs\\Lab 5")
setwd("C:/Users/Ryan Schlimme/OneDrive/Desktop/College/Spring 2024/PHY353L/Labs/Lab 5")
write.csv(Charge_mod, "C:\\Users\\Ryan Schlimme\\OneDrive\\Desktop\\College\\Spring 2024\\PHY353L\\Labs\\Lab 5")
write.csv(Charge_mod, "Charge_mod.csv")
